@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --foreground-rgb: 0, 0, 0;
  --background-rgb: 255, 255, 255;
  
  /* Modern Design System Colors */
  --primary: #1976d2;
  --primary-dark: #1565c0;
  --primary-light: #42a5f5;
  --secondary: #9c27b0;
  --accent: #00acc1;
  --success: #4caf50;
  --warning: #ff9800;
  --error: #f44336;
  --info: #2196f3;
  
  /* Neutral Colors */
  --gray-50: #fafafa;
  --gray-100: #f5f5f5;
  --gray-200: #eeeeee;
  --gray-300: #e0e0e0;
  --gray-400: #bdbdbd;
  --gray-500: #9e9e9e;
  --gray-600: #757575;
  --gray-700: #616161;
  --gray-800: #424242;
  --gray-900: #212121;
  
  /* Background Colors */
  --bg-primary: #ffffff;
  --bg-secondary: #f5f5f5;
  --bg-dark: #1a1a1a;
  --bg-card: #ffffff;
  --bg-overlay: rgba(0, 0, 0, 0.5);
  
  /* Text Colors */
  --text-primary: #212121;
  --text-secondary: #757575;
  --text-disabled: #bdbdbd;
  --text-inverse: #ffffff;
  
  /* Spacing Scale */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;
  
  /* Border Radius */
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;
  --radius-full: 9999px;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  
  /* Transitions */
  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Z-Index Scale */
  --z-dropdown: 1000;
  --z-sticky: 1020;
  --z-fixed: 1030;
  --z-modal-backdrop: 1040;
  --z-modal: 1050;
  --z-popover: 1060;
  --z-tooltip: 1070;
}

/* Prevent horizontal overflow and make it app-like */
html {
  scroll-behavior: smooth;
  overflow-x: hidden;
  width: 100%;
  height: 100%;
  height: -webkit-fill-available;
  height: 100dvh; /* Dynamic viewport height for mobile */
  -webkit-overflow-scrolling: touch;
  /* Prevent all overscroll/bounce effects */
  overscroll-behavior: none;
  overscroll-behavior-x: none;
  overscroll-behavior-y: none;
  /* Prevent zoom on double tap */
  touch-action: manipulation;
  /* Lock the viewport */
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

body {
  color: rgb(var(--foreground-rgb));
  background: rgb(var(--background-rgb));
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  height: -webkit-fill-available;
  height: 100dvh; /* Dynamic viewport height for mobile */
  overflow-x: hidden;
  overflow-y: hidden; /* Prevent body scroll - let children handle it */
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  -webkit-overflow-scrolling: touch;
  /* Prevent text selection on mobile for app-like feel */
  -webkit-tap-highlight-color: transparent;
  /* Prevent all overscroll/bounce effects */
  overscroll-behavior: none;
  overscroll-behavior-x: none;
  overscroll-behavior-y: none;
  /* Prevent zoom gestures but allow vertical scrolling in child elements */
  touch-action: pan-y pinch-zoom;
  /* Prevent pull-to-refresh */
  overscroll-behavior-block: none;
}

/* Polarsteps-style clean design */
* {
  box-sizing: border-box;
}

/* Smooth Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

/* Skeleton Loader */
.skeleton {
  background: linear-gradient(
    90deg,
    #f0f0f0 25%,
    #e0e0e0 50%,
    #f0f0f0 75%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: var(--radius-md);
}

/* Enhanced Button Styles */
.btn {
  @apply inline-flex items-center justify-center;
  @apply font-medium;
  @apply transition-all duration-200;
  @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
  @apply disabled:opacity-50 disabled:cursor-not-allowed;
  @apply active:scale-95;
}

.btn-primary {
  @apply bg-[#1976d2] text-white;
  @apply hover:bg-[#1565c0];
  @apply focus:ring-[#1976d2];
  @apply shadow-md hover:shadow-lg;
}

.btn-secondary {
  @apply bg-gray-200 text-gray-900;
  @apply hover:bg-gray-300;
  @apply focus:ring-gray-400;
}

.btn-ghost {
  @apply bg-transparent text-gray-700;
  @apply hover:bg-gray-100;
  @apply focus:ring-gray-300;
}

/* Enhanced Input Styles */
.input {
  @apply w-full px-4 py-3;
  @apply bg-white border border-gray-300 rounded-lg;
  @apply text-gray-900 placeholder-gray-500;
  @apply focus:outline-none focus:ring-2 focus:ring-[#1976d2] focus:border-transparent;
  @apply transition-all duration-200;
  @apply disabled:bg-gray-100 disabled:cursor-not-allowed;
}

/* Card Styles */
.card {
  @apply bg-white rounded-xl;
  @apply shadow-md hover:shadow-lg;
  @apply transition-all duration-300;
  @apply border border-gray-200;
}

.card-hover {
  @apply transform hover:scale-[1.02];
  @apply transition-all duration-300;
}

/* Smooth Transitions */
.transition-smooth {
  transition: all var(--transition-base);
}

/* Glass Morphism Effect */
.glass {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* Gradient Text */
.gradient-text {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Prevent horizontal overflow on all elements */
*,
*::before,
*::after {
  max-width: 100%;
}

/* Ensure root elements don't overflow */
#__next {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
  position: relative;
}

/* Exception: allow horizontal scrolling in specific containers */
#__next .horizontal-scroll {
  overflow-x: auto !important;
}

/* Ensure containers don't overflow */
#__next,
[data-nextjs-scroll-focus-boundary] {
  width: 100%;
  overflow-x: hidden;
}

/* Exception: allow horizontal scrolling */
#__next .horizontal-scroll,
[data-nextjs-scroll-focus-boundary] .horizontal-scroll {
  overflow-x: auto !important;
}

/* Leaflet map styles - Mobile optimized */
.leaflet-container {
  height: 100%;
  width: 100%;
  z-index: 0;
  max-width: 100%;
  border-radius: 12px;
  overflow: hidden;
}

/* Remove marker shadows and lines */
.leaflet-marker-shadow {
  display: none !important;
}

.leaflet-marker-icon {
  border: none !important;
  background: transparent !important;
}

.custom-person-marker,
.custom-location-marker {
  background: transparent !important;
  border: none !important;
}

@media (max-width: 768px) {
  .leaflet-container {
    border-radius: 16px;
  }
  
  /* Mobile map controls */
  .leaflet-control-zoom {
    margin: 10px !important;
  }
  
  .leaflet-control-zoom a {
    width: 36px !important;
    height: 36px !important;
    line-height: 36px !important;
    font-size: 20px !important;
  }
  
  /* Mobile popup */
  .leaflet-popup-content-wrapper {
    border-radius: 12px !important;
  }
  
  .leaflet-popup-content {
    margin: 12px 16px !important;
    font-size: 14px !important;
  }
}

/* Custom scrollbar - hide on mobile */
@media (max-width: 768px) {
  ::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }
  
  * {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
}

/* Desktop scrollbar */
@media (min-width: 769px) {
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  ::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
}

/* Mobile-specific styles for app-like experience */
@media (max-width: 768px) {
  html {
    /* Lock viewport completely on mobile */
    position: fixed;
    width: 100%;
    height: 100%;
    height: -webkit-fill-available;
    height: 100dvh;
    overflow: hidden;
    overscroll-behavior: none;
  }
  
  body {
    /* Lock body completely on mobile */
    position: fixed;
    width: 100%;
    height: 100%;
    height: -webkit-fill-available;
    height: 100dvh;
    overflow: hidden;
    /* Prevent all overscroll/bounce effects */
    overscroll-behavior: none;
    overscroll-behavior-x: none;
    overscroll-behavior-y: none;
    /* Prevent pull-to-refresh */
    overscroll-behavior-block: none;
  }
  
  /* Main app container should handle scrolling */
  #__next {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    height: -webkit-fill-available;
    height: 100dvh;
    overflow: hidden;
    overscroll-behavior: none;
  }
  
  /* Prevent text selection on buttons and interactive elements */
  button,
  a,
  [role="button"] {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
  }
  
  /* Allow text selection in input fields and text areas */
  input,
  textarea {
    -webkit-user-select: text;
    user-select: text;
  }
  
  /* Prevent zoom on double tap - but allow horizontal scrolling in scrollable containers */
  * {
    touch-action: pan-y;
    overscroll-behavior: none;
  }
  
  /* Allow scrolling only in specific containers */
  [class*="overflow-y-auto"],
  [class*="overflow-y-scroll"],
  .scrollable {
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior: contain !important;
    overscroll-behavior-y: contain !important;
  }
  
  /* Allow horizontal scrolling in containers with overflow-x-scroll or overflow-x-auto */
  [class*="overflow-x-scroll"],
  [class*="overflow-x-auto"],
  .horizontal-scroll {
    touch-action: pan-x !important;
    -webkit-overflow-scrolling: touch !important;
    overflow-x: scroll !important;
    overflow-y: hidden !important;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    scrollbar-width: thin;
    white-space: nowrap !important;
    width: 100% !important;
  }
  
  /* Safari-specific fixes for horizontal scrolling */
  @supports (-webkit-touch-callout: none) {
    .horizontal-scroll {
      display: block !important;
      -webkit-overflow-scrolling: touch !important;
      overflow-x: scroll !important;
      overflow-y: hidden !important;
    }
    
    .horizontal-scroll > div {
      display: flex !important;
      flex-direction: row !important;
      flex-wrap: nowrap !important;
    }
  }
  
  /* Ensure horizontal scroll containers can actually scroll */
  .horizontal-scroll,
  .horizontal-scroll * {
    max-width: none !important;
  }
  
  .horizontal-scroll > *,
  .horizontal-scroll > div > * {
    flex-shrink: 0 !important;
    min-width: 0 !important;
    white-space: normal !important;
  }
  
  /* Force horizontal scrolling to work */
  .horizontal-scroll {
    will-change: scroll-position !important;
    -webkit-transform: translateZ(0) !important;
    transform: translateZ(0) !important;
  }
  
  input,
  textarea,
  select {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }
  
  /* Mobile button styles - matching mobile app */
  button {
    min-height: 44px; /* iOS touch target size */
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
  }
  
  /* Mobile header styles */
  nav {
    padding: 12px 16px !important;
  }
  
  /* Mobile card styles */
  .card,
  [class*="Card"] {
    border-radius: 12px !important;
    padding: 16px !important;
  }
  
  /* Mobile spacing */
  .container,
  .max-w-4xl,
  .max-w-7xl {
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
  
  /* Mobile typography */
  h1 {
    font-size: 20px !important;
    line-height: 1.2 !important;
  }
  
  h2 {
    font-size: 16px !important;
    line-height: 1.3 !important;
  }
  
  h3 {
    font-size: 14px !important;
    line-height: 1.4 !important;
  }
  
  /* Mobile back button style */
  .back-button,
  [class*="back"] {
    font-size: 14px !important;
    color: #666 !important;
    font-weight: 500 !important;
    padding: 8px 0 !important;
  }
  
  /* Mobile add button style */
  .add-button,
  [class*="add"] {
    padding: 6px 12px !important;
    border: 1px solid #ddd !important;
    border-radius: 20px !important;
    font-size: 12px !important;
    color: #666 !important;
    font-weight: 500 !important;
    background: white !important;
  }
  
  /* Mobile submit button style */
  .submit-button,
  button[type="submit"],
  button.primary {
    background: #000 !important;
    color: white !important;
    border-radius: 24px !important;
    padding: 12px 24px !important;
    font-weight: 600 !important;
    border: none !important;
  }
  
  /* Mobile cancel button style */
  .cancel-button,
  button.secondary {
    border: 1px solid #ddd !important;
    border-radius: 24px !important;
    padding: 12px 24px !important;
    color: #666 !important;
    background: white !important;
    font-weight: 500 !important;
  }
}

/* Ensure images don't overflow */
img {
  max-width: 100%;
  height: auto;
  display: block;
  object-fit: contain;
}

/* Prevent video and iframe overflow */
video,
iframe,
embed,
object {
  max-width: 100%;
  height: auto;
}

/* Prevent tables from overflowing */
table {
  width: 100%;
  table-layout: fixed;
  word-wrap: break-word;
}

/* Ensure all containers respect viewport */
.container,
.max-w-7xl,
.max-w-4xl,
.max-w-2xl,
.max-w-xl {
  width: 100%;
  max-width: 100%;
  padding-left: 1rem;
  padding-right: 1rem;
  box-sizing: border-box;
}

@media (min-width: 640px) {
  .container,
  .max-w-7xl,
  .max-w-4xl,
  .max-w-2xl,
  .max-w-xl {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }
}

/* Prevent overflow on common layout elements */
main,
section,
article,
div[role="main"] {
  max-width: 100%;
  overflow-x: hidden;
}

/* Ensure MUI containers don't overflow */
.MuiContainer-root {
  max-width: 100% !important;
  padding-left: 1rem !important;
  padding-right: 1rem !important;
  box-sizing: border-box !important;
}

@media (min-width: 600px) {
  .MuiContainer-root {
    padding-left: 1.5rem !important;
    padding-right: 1.5rem !important;
  }
}

/* Prevent horizontal scroll on grid layouts */
.grid,
[class*="grid"] {
  max-width: 100%;
  overflow-x: hidden;
}

/* Ensure cards and boxes don't overflow */
.card,
[class*="Card"],
[class*="Box"] {
  max-width: 100%;
  box-sizing: border-box;
}

/* Prevent text overflow */
p,
span,
div,
h1,
h2,
h3,
h4,
h5,
h6 {
  word-wrap: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

  /* Ensure flex containers don't overflow */
  .flex,
  [class*="flex"] {
    min-width: 0;
    max-width: 100%;
  }
  
  /* Exception for horizontal scroll containers */
  .horizontal-scroll .flex,
  .horizontal-scroll [class*="flex"] {
    min-width: max-content !important;
    max-width: none !important;
  }

/* Ensure grid items don't overflow */
.grid > *,
[class*="grid"] > * {
  min-width: 0;
  max-width: 100%;
  overflow: hidden;
}

/* Prevent horizontal scroll on tables */
table {
  display: block;
  overflow-x: auto;
  white-space: nowrap;
  -webkit-overflow-scrolling: touch;
}

@media (max-width: 768px) {
  table {
    font-size: 0.875rem;
  }
}

/* Ensure form elements don't overflow */
input,
textarea,
select {
  max-width: 100%;
  box-sizing: border-box;
}

/* Prevent code blocks from overflowing */
pre,
code {
  max-width: 100%;
  overflow-x: auto;
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* Hide MapLibre attribution */
.maplibregl-ctrl-attrib {
  display: none !important;
}

.maplibregl-ctrl-bottom-right {
  display: none !important;
}

